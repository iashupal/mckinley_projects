(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{1675:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(module) {/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(0);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(45);\n/* harmony import */ var _material_ui_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(32);\n/* harmony import */ var _material_ui_core__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_material_ui_core__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var components_ContentCard__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(113);\n/* harmony import */ var components_Table_EnhancedTable__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(73);\n/* harmony import */ var components_AlignBox__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(53);\n/* harmony import */ var components_Button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(19);\n/* harmony import */ var components_BoxOld__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(27);\n/* harmony import */ var helpers_ui__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(29);\n/* harmony import */ var components_PageTitle__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(547);\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(434);\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(xlsx__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var react_datasheet__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2081);\n/* harmony import */ var react_datasheet__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(react_datasheet__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var react_dropzone__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(208);\n/* harmony import */ var helpers_ramda__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(6);\n/* harmony import */ var _Redux_Action__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(76);\n(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== \'undefined\' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nfunction _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar __signature__ = typeof reactHotLoaderGlobal !== \'undefined\' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar getLastNumber = helpers_ramda__WEBPACK_IMPORTED_MODULE_13__[/* RU */ "c"].getLastNumber,\n    mlMessage = helpers_ramda__WEBPACK_IMPORTED_MODULE_13__[/* RU */ "c"].mlMessage;\nvar fieldColumn = [\'A\', \'B\', \'C\', \'D\', \'E\', \'F\', \'G\', \'H\', \'I\', \'J\', \'K\', \'L\']; // GET 대상 (엑셀)열, 정의. A,B,C,...\n// DB 컬럼명 fix 되면 수정 해야함.\n\nvar fixFieldName = [\'CaseName\', \'ManagementNo\', \'CaseCategory\', \'CourtLevel\', \'BackgroundInfo\', \'Court\', \'EndDate\', \'RepresentativeName\', \'Lawyer\', \'Performer\', \'Assistant\', \'CaseStatus\']; // 실제 Server 요청, 필드명\n\nvar fixFieldDisplay = [{\n  name: \'송무\',\n  star: false\n}, {\n  name: \'송무번호\',\n  star: false\n}, {\n  name: \'송무분류\',\n  star: false\n}, {\n  name: \'심급\',\n  star: false\n}, {\n  name: \'송무설명\',\n  star: false\n}, {\n  name: \'계속기관\',\n  star: false\n}, {\n  name: \'기일(잔여일)\',\n  star: false\n}, {\n  name: \'의뢰인\',\n  star: false\n}, {\n  name: \'수임자\',\n  star: false\n}, {\n  name: \'수행자\',\n  star: false\n}, {\n  name: \'보조자\',\n  star: false\n}, {\n  name: \'상태\',\n  star: false\n}]; // 사용자 표기용 필드\n\nvar ExcelUpload =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ExcelUpload, _React$Component);\n\n  function ExcelUpload() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ExcelUpload);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ExcelUpload)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), "state", {\n      data: [],\n      dataResult: [],\n      isLoading: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), "convertExcelDate", function (excelDate) {\n      var date = new Date((excelDate - (25567 + 2)) * 86400 * 1000);\n      var year = date.getFullYear();\n      var month = date.getMonth() + 1 < 10 ? "0".concat(date.getMonth() + 1) : date.getMonth() + 1;\n      var day = date.getDate() < 10 ? "0".concat(date.getDate()) : date.getDate();\n      var formattedDate = "".concat(year, "-").concat(month, "-").concat(day);\n      return formattedDate;\n    });\n\n    return _this;\n  }\n\n  _createClass(ExcelUpload, [{\n    key: "render",\n    value: function render() {\n      var _this2 = this;\n\n      var classes = this.props.classes;\n      var dropzoneRef;\n      return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {\n        className: classes.container\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_BoxOld__WEBPACK_IMPORTED_MODULE_7__[/* default */ "a"], {\n        mb: 1,\n        display: "flex",\n        flexDirection: "row",\n        flexWrap: "wrap",\n        justifyContent: "space-between",\n        alignItems: "center"\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_PageTitle__WEBPACK_IMPORTED_MODULE_9__[/* default */ "a"], {\n        icon: "class"\n      }, mlMessage(\'pages.litigation.excelUpload.title\'))), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {\n        className: classes.content\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_ContentCard__WEBPACK_IMPORTED_MODULE_3__[/* default */ "a"], {\n        title: "",\n        customHeader: react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_AlignBox__WEBPACK_IMPORTED_MODULE_5__[/* default */ "a"], {\n          justifyContent: "flex-end"\n        }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("a", {\n          href: "/file/Sample_CaseList.xlsx",\n          download: true\n        }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_Button__WEBPACK_IMPORTED_MODULE_6__[/* default */ "a"], {\n          icon: "archive",\n          color: "primary",\n          onClick: function onClick(e) {}\n        }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_BoxOld__WEBPACK_IMPORTED_MODULE_7__[/* default */ "a"], {\n          pr: 2\n        }, mlMessage(\'pages.litigation.excelUpload.templateDownload\')))), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_Button__WEBPACK_IMPORTED_MODULE_6__[/* default */ "a"], {\n          icon: "unarchive",\n          color: "primary",\n          onClick: function onClick(e) {\n            dropzoneRef.open();\n          }\n        }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_BoxOld__WEBPACK_IMPORTED_MODULE_7__[/* default */ "a"], {\n          pr: 2\n        }, mlMessage(\'pages.litigation.excelUpload.upload\')))),\n        contents: [react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {\n          className: "row"\n        }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {\n          className: "col-md-12"\n        }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_datasheet__WEBPACK_IMPORTED_MODULE_11___default.a, {\n          data: this.state.data,\n          valueRenderer: function valueRenderer(i) {\n            return i.value;\n          },\n          sheetRenderer: function sheetRenderer(props) {\n            var fullData = props.children;\n            var body = [];\n            fullData.forEach(function (record) {\n              var row = {};\n              row.id = record.key;\n              record.props.cells.forEach(function (cell, idx) {\n                if (idx === 6) {\n                  row[idx] = _this2.convertExcelDate(cell.value);\n                } else if (idx === 11) {\n                  var color = cell.value === \'진행중\' ? \'badge text-white bg-green\' : \'badge text-white bg-black\';\n                  row[idx] = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {\n                    style: {\n                      width: \'70px\'\n                    },\n                    className: color\n                  }, cell.value);\n                } else {\n                  row[idx] = cell.value;\n                }\n              });\n              body.push(row);\n            });\n            return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_Table_EnhancedTable__WEBPACK_IMPORTED_MODULE_4__[/* default */ "c"], {\n              hidePagination: true,\n              hideFilter: true,\n              rows: fixFieldDisplay.map(function (col, index) {\n                var culumnName = col.name;\n                var align = \'center\';\n                if (index === 0 || index === 4) align = \'left\';\n                return {\n                  id: index,\n                  numeric: false,\n                  disablePadding: false,\n                  label: culumnName,\n                  align: align\n                };\n              }),\n              data: body,\n              useCheckBox: true,\n              mngIconsBatch: function mngIconsBatch(arr) {\n                return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_Button__WEBPACK_IMPORTED_MODULE_6__[/* default */ "a"], {\n                  size: "square",\n                  icon: "delete",\n                  color: "danger",\n                  onClick: function onClick() {\n                    alert("time|".concat(arr));\n                  }\n                });\n              }\n            });\n          },\n          cellRenderer: function cellRenderer(props) {\n            return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("td", {\n              style: {\n                textAlign: \'center\',\n                borderStyle: \'solid\',\n                borderWidth: \'1px\'\n              }\n            }, props.children);\n          },\n          onCellsChanged: function onCellsChanged(changes) {\n            var data = _this2.state.data.map(function (row) {\n              return _toConsumableArray(row);\n            });\n\n            changes.forEach(function (_ref) {\n              var cell = _ref.cell,\n                  row = _ref.row,\n                  col = _ref.col,\n                  value = _ref.value;\n              data[row][col] = Object.assign({}, data[row][col], {\n                value: value\n              });\n            });\n\n            _this2.setState(Object.assign({}, _this2.state, {\n              data: data\n            }));\n          }\n        })))]\n      }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {\n        className: classes.submitButtonContainer\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_Button__WEBPACK_IMPORTED_MODULE_6__[/* default */ "a"], {\n        color: "primary",\n        size: "large",\n        mode: "regular",\n        onClick: function onClick(e) {}\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_BoxOld__WEBPACK_IMPORTED_MODULE_7__[/* default */ "a"], {\n        pl: 5,\n        pr: 5\n      }, mlMessage(\'pages.common.button.save\'))), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_Button__WEBPACK_IMPORTED_MODULE_6__[/* default */ "a"], {\n        color: "inverted",\n        size: "large",\n        mode: "regular",\n        onClick: function onClick(e) {\n          _this2.setState(Object.assign({}, _this2.state, {\n            data: []\n          }));\n        }\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(components_BoxOld__WEBPACK_IMPORTED_MODULE_7__[/* default */ "a"], {\n        pl: 5,\n        pr: 5\n      }, mlMessage(\'pages.common.button.reset\')))), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_dropzone__WEBPACK_IMPORTED_MODULE_12__[/* default */ "a"], {\n        ref: function ref(node) {\n          dropzoneRef = node;\n        },\n        style: {\n          display: \'none\'\n        },\n        onDrop:\n        /*#__PURE__*/\n        function () {\n          var _ref2 = _asyncToGenerator(\n          /*#__PURE__*/\n          regeneratorRuntime.mark(function _callee(accepted, rejected) {\n            return regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _this2.setState(Object.assign({}, _this2.state, {\n                      isLoading: true\n                    }), function () {\n                      var file = accepted[0];\n                      var reader = new FileReader();\n\n                      reader.onload = function (e) {\n                        var data = e.target.result;\n                        var workbook = xlsx__WEBPACK_IMPORTED_MODULE_10___default.a.read(data, {\n                          type: \'binary\'\n                        });\n                        var table = workbook.Sheets.Sheet1;\n                        var currRow = 1; // const fieldNames = R.map(a => table[a + currRow].v, fieldColumn);\n\n                        var rangeArr = table[\'!ref\'].split(\':\'); // const startCell = rangeArr[0];\n\n                        var endCell = rangeArr[1];\n                        var lastNumber = getLastNumber(endCell);\n                        var tableJSON = [];\n\n                        while (currRow++ < lastNumber) {\n                          var newRow = helpers_ramda__WEBPACK_IMPORTED_MODULE_13__[/* R */ "b"].map(function (a) {\n                            var value = table[a + currRow] ? table[a + currRow].v : null;\n                            return {\n                              value: value\n                            };\n                          }, fieldColumn);\n                          tableJSON.push(newRow);\n                        }\n\n                        _this2.setState(Object.assign({}, _this2.state, {\n                          data: tableJSON,\n                          isLoading: false\n                        }));\n                      };\n\n                      reader.readAsBinaryString(file);\n                    });\n\n                  case 1:\n                  case "end":\n                    return _context.stop();\n                }\n              }\n            }, _callee);\n          }));\n\n          return function (_x, _x2) {\n            return _ref2.apply(this, arguments);\n          };\n        }()\n      }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(helpers_ui__WEBPACK_IMPORTED_MODULE_8__[/* LoadingBox */ "e"], {\n        isLoading: this.state.isLoading\n      })));\n    }\n  }, {\n    key: "__reactstandin__regenerateByEval",\n    // @ts-ignore\n    value: function __reactstandin__regenerateByEval(key, code) {\n      // @ts-ignore\n      this[key] = eval(code);\n    }\n  }]);\n\n  return ExcelUpload;\n}(react__WEBPACK_IMPORTED_MODULE_0___default.a.Component);\n\nvar styles = function styles(theme) {\n  return {\n    container: _defineProperty({\n      gridTemplateColumns: \'1fr\',\n      padding: 30,\n      fontFamily: \'Roboto, Helvetica, Arial, sans-serif\'\n    }, theme.breakpoints.down(\'md\'), {\n      padding: \'20px\'\n    }),\n    submitButtonContainer: {\n      marginTop: \'10px\',\n      width: \'100%\',\n      textAlign: \'center\'\n    }\n  };\n};\n\nvar mapStateToProps = function mapStateToProps(_ref3) {\n  var case_ = _ref3.case_;\n  var excelUpload = case_.excelUpload;\n  var caseList = excelUpload.caseList;\n  return {\n    caseList: caseList\n  };\n};\n\nvar mapDispatchToProps = {\n  setReduxValues: _Redux_Action__WEBPACK_IMPORTED_MODULE_14__[/* setReduxValues */ "k"]\n};\n\nvar _default = Object(react_redux__WEBPACK_IMPORTED_MODULE_1__[/* connect */ "b"])(mapStateToProps, mapDispatchToProps)(Object(_material_ui_core__WEBPACK_IMPORTED_MODULE_2__["withStyles"])(styles)(ExcelUpload));\n\n/* harmony default export */ __webpack_exports__["default"] = (_default);\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== \'undefined\' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(getLastNumber, "getLastNumber", "/home/ashu/projects/LawFirm_new/LawFirm/src/app/routes/Case/View/ExcelUpload/index.js");\n  reactHotLoader.register(mlMessage, "mlMessage", "/home/ashu/projects/LawFirm_new/LawFirm/src/app/routes/Case/View/ExcelUpload/index.js");\n  reactHotLoader.register(fieldColumn, "fieldColumn", "/home/ashu/projects/LawFirm_new/LawFirm/src/app/routes/Case/View/ExcelUpload/index.js");\n  reactHotLoader.register(fixFieldName, "fixFieldName", "/home/ashu/projects/LawFirm_new/LawFirm/src/app/routes/Case/View/ExcelUpload/index.js");\n  reactHotLoader.register(fixFieldDisplay, "fixFieldDisplay", "/home/ashu/projects/LawFirm_new/LawFirm/src/app/routes/Case/View/ExcelUpload/index.js");\n  reactHotLoader.register(ExcelUpload, "ExcelUpload", "/home/ashu/projects/LawFirm_new/LawFirm/src/app/routes/Case/View/ExcelUpload/index.js");\n  reactHotLoader.register(styles, "styles", "/home/ashu/projects/LawFirm_new/LawFirm/src/app/routes/Case/View/ExcelUpload/index.js");\n  reactHotLoader.register(mapStateToProps, "mapStateToProps", "/home/ashu/projects/LawFirm_new/LawFirm/src/app/routes/Case/View/ExcelUpload/index.js");\n  reactHotLoader.register(mapDispatchToProps, "mapDispatchToProps", "/home/ashu/projects/LawFirm_new/LawFirm/src/app/routes/Case/View/ExcelUpload/index.js");\n  reactHotLoader.register(_default, "default", "/home/ashu/projects/LawFirm_new/LawFirm/src/app/routes/Case/View/ExcelUpload/index.js");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== \'undefined\' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(8)(module)))\n\n//# sourceURL=app/routes/Case/View/ExcelUpload/index.js')}}]);